% To illustrate the functionality of the toolbox we use a famous Fischer's Iris Data Set [https://archive.ics.uci.edu/ml/datasets/Iris], 
% which consists of three classes of 50 samples each. 
% The classes correspond to Iris species: Setosa (class 1), Versicolor (class 2), and Virginica (class 3).
% In classification, each class is consequently used as a target versus two remaining classes. 
% For modeling, each dataset is divided into two parts: the training (40 samples) and the test (10 samples) sets. 
% The first set is used to train the classifier, while the second set is employed for the method validation.
% Each class is modeled separately, independent of the others, as DD-SIMCA is a one-class classifier.

clc
clear
close all

%Create data sets
setosa_test = [5,3.5,1.3,0.3;...
                4.5,2.3,1.3,0.3;...
                4.4,3.2,1.3,0.2;...
                5,3.5,1.6,0.6;...
                5.1,3.8,1.9,0.4;...
                4.8,3,1.4,0.3;...
                5.1,3.8,1.6,0.2;...
                4.6,3.2,1.4,0.2;...
                5.3,3.7,1.5,0.2;...
                5,3.3,1.4,0.2];

setosa_training = [5.1,3.5,1.4,0.2;...
                    4.9,3,1.4,0.2;...
                    4.7,3.2,1.3,0.2;...
                    4.6,3.1,1.5,0.2;...
                    5,3.6,1.4,0.2;...
                    5.4,3.9,1.7,0.4;...
                    4.6,3.4,1.4,0.3;...
                    5,3.4,1.5,0.2;...
                    4.4,2.9,1.4,0.2;...
                    4.9,3.1,1.5,0.1;...
                    5.4,3.7,1.5,0.2;...
                    4.8,3.4,1.6,0.2;...
                    4.8,3,1.4,0.1;...
                    4.3,3,1.1,0.1;...
                    5.8,4,1.2,0.2;...
                    5.7,4.4,1.5,0.4;...
                    5.4,3.9,1.3,0.4;...
                    5.1,3.5,1.4,0.3;...
                    5.7,3.8,1.7,0.3;...
                    5.1,3.8,1.5,0.3;...
                    5.4,3.4,1.7,0.2;...
                    5.1,3.7,1.5,0.4;...
                    4.6,3.6,1,0.2;...
                    5.1,3.3,1.7,0.5;...
                    4.8,3.4,1.9,0.2;...
                    5,3,1.6,0.2;...
                    5,3.4,1.6,0.4;
                    5.2,3.5,1.5,0.2;...
                    5.2,3.4,1.4,0.2;...
                    4.7,3.2,1.6,0.2;...
                    4.8,3.1,1.6,0.2;...
                    5.4,3.4,1.5,0.4;...
                    5.2,4.1,1.5,0.1;...
                    5.5,4.2,1.4,0.2;...
                    4.9,3.1,1.5,0.2;...
                    5,3.2,1.2,0.20;...
                    5.5,3.5,1.3,0.2;...
                    4.9,3.6,1.4,0.1;...
                    4.4,3,1.3,0.2;...
                    5.1,3.4,1.5,0.2];
                
versicolor_test = [5.5,2.6,4.4,1.2;...
                    6.1,3,4.6,1.4;...
                    5.8,2.6,4,1.2;...
                    5,2.3,3.3,1;...
                    5.6,2.7,4.2,1.3;...
                    5.7,3,4.2,1.2;...
                    5.7,2.9,4.2,1.3;...
                    6.2,2.9,4.3,1.3;...
                    5.1,2.5,3,1.1;...
                    5.7,2.8,4.1,1.3];
                
versicolor_training = [7,3.2,4.7,1.4;...
                        6.4,3.2,4.5,1.5;...
                        6.9,3.1,4.9,1.5;...
                        5.5,2.3,4,1.3;...
                        6.5,2.8,4.6,1.5;...
                        5.7,2.8,4.5,1.3;...
                        6.3,3.3,4.7,1.6;...
                        4.9,2.4,3.3,1;...
                        6.6,2.9,4.6,1.3;...
                        5.2,2.7,3.9,1.4;...
                        5,2,3.5,1;...
                        5.9,3,4.2,1.5;...
                        6,2.2,4,1;...
                        6.1,2.9,4.7,1.4;...
                        5.6,2.9,3.6,1.3;...
                        6.7,3.1,4.4,1.4;...
                        5.6,3,4.5,1.5;...
                        5.8,2.7,4.1,1;...
                        6.2,2.2,4.5,1.5;...
                        5.6,2.5,3.9,1.1;...
                        5.9,3.2,4.8,1.8;...
                        6.1,2.8,4,1.3;...
                        6.3,2.5,4.9,1.5;...
                        6.1,2.8,4.7,1.2;...
                        6.4,2.9,4.3,1.3;...
                        6.6,3,4.4,1.4;...
                        6.8,2.8,4.8,1.4;...
                        6.7,3,5,1.7;...
                        6,2.9,4.5,1.5;...
                        5.7,2.6,3.5,1;...
                        5.5,2.4,3.8,1.1;...
                        5.5,2.4,3.7,1;...
                        5.8,2.7,3.9,1.2;...
                        6,2.7,5.1,1.6;...
                        5.4,3,4.5,1.5;...
                        6,3.4,4.5,1.6;...
                        6.7,3.1,4.7,1.5;...
                        6.3,2.3,4.4,1.3;...
                        5.6,3,4.1,1.3;...
                        5.5,2.5,4,1.3];

virginica_test = [6.7,3.1,5.6,2.4;...
                   6.9,3.1,5.1,2.3;...
                   5.8,2.7,5.1,1.9;...
                   6.8,3.2,5.9,2.3;...
                   6.7,3.3,5.7,2.5;...
                   6.7,3,5.2,2.3;...
                   6.3,2.5,5,1.9;...
                   6.5,3,5.2,2;...
                   6.2,3.4,5.4,2.3;...
                   5.9,3,5.1,1.8];
               
virginica_training = [6.3,3.3,6,2.5;...
                   5.8,2.7,5.1,1.9;...
                   7.1,3,5.9,2.1;...
                   6.3,2.9,5.6,1.8;...
                   6.5,3,5.8,2.2;...
                   7.6,3,6.6,2.1;...
                   4.9,2.5,4.5,1.7;...
                   7.3,2.9,6.3,1.8;...
                   6.7,2.5,5.8,1.8;...
                   7.2,3.6,6.1,2.5;...
                   6.5,3.2,5.1,2;...
                   6.4,2.7,5.3,1.9;...
                   6.8,3,5.5,2.1;...
                   5.7,2.5,5,2;...
                   5.8,2.8,5.1,2.4;...
                   6.4,3.2,5.3,2.3;...
                   6.5,3,5.5,1.8;...
                   7.7,3.8,6.7,2.2;...
                   7.7,2.6,6.9,2.3;...
                   6,2.2,5,1.5;...
                   6.9,3.2,5.7,2.3;...
                   5.6,2.8,4.9,2;...
                   7.7,2.8,6.7,2;...
                   6.3,2.7,4.9,1.8;...
                   6.7,3.3,5.7,2.1;...
                   7.2,3.2,6,1.8;...
                   6.2,2.8,4.8,1.8;...
                   6.1,3,4.9,1.8;...
                   6.4,2.8,5.6,2.1;...
                   7.2,3,5.8,1.6;...
                   7.4,2.8,6.1,1.9;...
                   7.9,3.8,6.4,2;...
                   6.4,2.8,5.6,2.2;...
                   6.3,2.8,5.1,1.5;...
                   6.1,2.6,5.6,1.4;...
                   7.7,3,6.1,2.3;...
                   6.3,3.4,5.6,2.4;...
                   6.4,3.1,5.5,1.8;...
                   6,3,4.8,1.8;...
                   6.9,3.1,5.4,2.1];

% Create arrays of labels for the test sets
setosa_test_names = {'se41';'se42';'se43';'se44';'se45';'se46';'se47';'se48';'se49';'se50'};
versicolor_test_names = {'ve41';'ve42';'ve43';'ve44';'ve45';'ve46';'ve47';'ve48';'ve49';'ve50'};
virginica_test_names = {'vi41';'vi42';'vi43';'vi44';'vi45';'vi46';'vi47';'vi48';'vi49';'vi50'};
               
% The test sets presented here are a combination of all 3 classes. 
% Each sample has a label with prefix SE, VE and VI 
% which indicates the class of the sample.

TestSet = [setosa_test; versicolor_test; virginica_test];
TestSetNames = [setosa_test_names, versicolor_test_names, virginica_test_names];

% Model parameters
numPC = 2;
Gamma = 0.01;
Alpha = 0.01;

% Test parameter
TargetClass = 3;

switch TargetClass
    case 1
        TrainingSet = setosa_training;
    case 2
        TrainingSet = versicolor_training;
    case 3
        TrainingSet = virginica_training;
end

% Create the DD-Simca model object
Model = DDSimca(TrainingSet, numPC);

% Adjust the model parameters
Model.Centering = true;
Model.Alpha = Alpha;
Model.Gamma = Gamma;

% Create and show Acceptance and Extreme Plots for the Training Set
Model.AcceptancePlot();
[N,Nplus,Nminus] = Model.ExtremePlot();

% Create the DD-Simca task object for the new data (Test Set)
NewClass = DDSTask(Model, TestSet);
NewClass.Labels = TestSetNames;
NewClass.ShowLabels = true;

% Create and show Acceptance Plot for the Test Set
NewClass.AcceptancePlot();

% Show the calculated type II error Beta and Warning
NewClass.Beta
NewClass.Warning
